{% extends "dashboard/base.html" %}
{% block title %}Walk-in Booking{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto p-4">

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

        <!-- LEFT: Form -->
        <div class="box token-card">
            <h2 class="title is-5 text-center">ðŸ§¾ Walk-in Booking</h2>

            <div class="field">
                <label class="label">Doctor ID</label>
                <input id="doctor_id" class="input py-3 text-lg" type="number">
            </div>

            <div class="field">
                <label class="label">Patient Name</label>
                <input id="patient_name" class="input py-3 text-lg" type="text">
            </div>

            <button id="book" class="w-full min-h-[44px] py-3 px-4
                       text-lg font-semibold rounded-lg
                       bg-green-600 hover:bg-green-700
                       text-white">
                âž• Create Walk-in Token
            </button>
        </div>

        <!-- RIGHT: Result -->
        <div class="box token-card flex items-center justify-center">
            <div id="out" class="text-lg text-center text-gray-700"></div>
        </div>

    </div>
</div>

<script>
    document.getElementById('book').onclick = async () => {
        const doctor_id = Number(doctor_id.value);
        const patient_name = patient_name.value.trim();

        if (!doctor_id || !patient_name)
            return alert('Doctor ID and patient name required');

        const resp = await fetch('/api/token_queue/walkin/', {
            method: 'POST',
            credentials: 'same-origin',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ doctor_id, patient_name })
        });

        const data = await resp.json();
        out.innerText = `âœ… Token #${data.token_number} created\nETA: ${data.eta}`;
    };
</script>
{% endblock %}